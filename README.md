# Typewriter (Unofficial fork)

Typewriter is a Visual Studio extensions that generates TypeScript files from c# code files using TypeScript Templates.
This allows you to create fully typed TypeScript representations of server side API, models, controllers, SignalR hubs etc. that automatically updates when you make changes to your c# code.

[Original Documentation](http://frhagn.github.io/Typewriter)  
[Download Last Unofficial Version](https://github.com/AdaskoTheBeAsT/Typewriter/releases)

## Why new fork?

It seems that Fredrik Hagnelius author of Typewriter is very busy and do not have enough time for supporting that extensions.
From the other side that extensions really helps fullstack developers and work on it should be continued.

## Issues

The issue tracker is the preferred channel for bug reports, features requests and submitting pull requests.   
For personal support requests Stack Overflow is a better place to get help. Please use the   [typewriter](http://stackoverflow.com/questions/tagged/typewriter) tag when posting your questions.

## Getting started

Step 1: Add a TypeScript Template file (.tst)  
Step 2: Add the following code in the template

```typescript
$Classes(*Model)[ // Find all classes with a name ending with Model
    class $Name {
        constructor($Properties[public $name: $Type][, ]) {
        }
    }
]
```

Step 3: Save the template  
Step 4: Add a c# class named TestModel  
Step 5: Add the following code to the class

```c#
using System;

namespace TestApplication
{
    public class TestModel
    {
        public int Id { get; set; }
        public int Name { get; set; }
    }
}
```

Step 6: Save the class.  

Each time a class matching the filter in the template is saved a TypeScript class matching the template is updated or added to the project.

## Advanced usage of templates 

Repository [https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes) shows advanced generation of classes, interfaces, enums, records, etc. using Typewriter. It uses polymorphic capabilities of Newtonsoft.Json to properly generate TypeScript classes with polymorphiysm enabled - by using $type property. It also contains brand new generation of classes using System.Text.Json with polymorphic capabilities upcoming in .NET 7. 

### .NET 6 Newtonsoft.Json

1. Angular sample .NET 6

- Base class annotated with JsonDerivedType (for generator purposes discriminators are mixed string, number and nameof - which is string - normally you should use one convention)
  [ComplexBaseModel.cs](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample/Models/ComplexBaseModel.cs)
- TypeScript autogenerated version
  [ComplexBaseModel.ts](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample/ClientApp/apps/client-app/src/api/models/ComplexBaseModel.ts)
- Derived class
  [ComplexAModel.cs](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample/Models/ComplexAModel.cs)
- TypeScript autogenerated version
  [ComplexAModel.ts](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample/ClientApp/apps/client-app/src/api/models/ComplexAModel.ts)
- [code for generating models](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/tree/master/src/AngularWebApiSample/ClientApp/apps/client-app/src/api/models/_AutogeneratedModels.tst)
- sample contains also enum and records generation
- Angular also contains automatic generation of service classes from controllers - by using [code for generating services](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/tree/master/src/AngularWebApiSample/ClientApp/apps/client-app/src/api/services/_AutogeneratedServices.tst)

1. React sample .NET 6
 - use same ideas as in Angular sample - it is only limited to models due to multitude of possible creation api connecting functions [ReactWebApiSample2](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/tree/master/src/ReactWebApiSample)

### .NET 7 System.Text.Json

To show new functionality with polymorphism [https://devblogs.microsoft.com/dotnet/system-text-json-in-dotnet-7/#using-type-discriminators](https://devblogs.microsoft.com/dotnet/system-text-json-in-dotnet-7/#using-type-discriminators)
Please see in samples:

1. Angular sample .NET 7

- Base class annotated with JsonDerivedType (for generator purposes discriminators are mixed string, number and nameof - which is string - normally you should use one convention)
  [ComplexBaseModel.cs](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample2/Models/ComplexBaseModel.cs)
- TypeScript autogenerated version
  [ComplexBaseModel.ts](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample2/ClientApp/apps/client-app/src/api/models/ComplexBaseModel.ts)
- Derived class
  [ComplexAModel.cs](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample2/Models/ComplexAModel.cs)
- TypeScript autogenerated version
  [ComplexAModel.ts](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/blob/master/src/AngularWebApiSample2/ClientApp/apps/client-app/src/api/models/ComplexAModel.ts)
- [code for generating models](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/tree/master/src/AngularWebApiSample2/ClientApp/apps/client-app/src/api/models/_AutogeneratedModels.tst)
- sample contains also enum and records generation
- Angular also contains automatic generation of service classes from controllers - by using [code for generating services](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/tree/master/src/AngularWebApiSample2/ClientApp/apps/client-app/src/api/services/_AutogeneratedServices.tst)

1. React sample .NET 7
 - use same ideas as in Angular sample - it is only limited to models due to multitude of possible creation api connecting functions [ReactWebApiSample2](https://github.com/AdaskoTheBeAsT/NetCoreTypewriterRecipes/tree/master/src/ReactWebApiSample2)

### Code generation logging

In order to log code generation process you can use following code in your template

Define static ILog field;

```csharp
static ILog log;
```

In constructor initialize it;

```csharp
Template(Settings settings)
{
    log = settings.Log;
}
```

use it within template in methods

```csharp
bool IncludeClass(Class c){
    if(!c.Namespace.StartsWith("AngularWebApiSample"))
    {
        return false;
    }

    var attr = c.Attributes.FirstOrDefault(p => p.Name == "GenerateFrontendType");
    if(attr == null){
        return false;
    }

    var parent = c.BaseClass;
    if(parent != null){
        if(parent.Name.EndsWith("Controller")
      || parent.Name.EndsWith("ControllerBase"))
      {
        return false;
      }
    }

    log.LogInfo($"Processing class {c.Name}");

    return true;
}
```

this is output from log:

![Logging From Template](./images/LoggingFromTemplate.png)

## Main differences between original and this fork

## Version 2.35.0

- fixed ClassName Type extension method to return correct name for nullable types

## Version 2.34.0

- added posibility to log from template as described in `Code generation logging` section. Closes #21

## Version 2.33.0

- version compatible with VS 17.12.3
- fixed #47 - nullable types not correctly represented in ts files

## Version 2.32.0

version compatible with VS 2022 17.11.1
added ability to obtain full path of the current template ([#50](https://github.com/AdaskoTheBeAsT/Typewriter/issues/50) thanks @tcables for raising issue)
usage:

```csharp
static string templatePath;

Template(Settings settings)
{
    settings
        .IncludeCurrentProject()
        .IncludeReferencedProjects()
        .UseStringLiteralCharacter('\'')
        .DisableUtf8BomGeneration()
        ;
    ......
    templatePath = settings.TemplatePath;
}
```

## Version 2.31.0

- expose Interface.Type [#46](https://github.com/AdaskoTheBeAsT/Typewriter/pull/46) thanks to @Fasteroid

## Version 2.30.0

- add 'Type' property to Attribute class [#45](https://github.com/AdaskoTheBeAsT/Typewriter/pull/45) thanks to @Fasteroid

## Version 2.29.0

- thanks to @Fasteroid Add FileLocation property to Type class - This will allow users to generate accurate import paths, even for files containing multiple classes. [PR 44](https://github.com/AdaskoTheBeAsT/Typewriter/pull/44)
- updated libs

## Version 2.28.0

- version compatible with VS 2022 17.9.5

## Version 2.27.0

- upgraded dependencies
- compatible with VS 2022 v17.9.2

## Version 2.26.0

- version compatible with VS 17.8.4
- added error logging when generating file

## Version 2.25.0

- using long path processing only in situation when key ```HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\FileSystem\LongPathsEnabled``` is set to 1

## Version 2.24.0

- experimental release for arm64
- compatible with VS 17.8.3

## Version 2.23.0

- default BOM generation to true - add possibility to disable in settings. Closes #40
- version compatible with VS 17.8.2

## Version 2.22.0

- fix for non normalized long paths

## Version 2.21.0

- optimized output generation
- create directory for output if it does not exists
- simplified logic for long paths

## Version 2.20.0

- #37 sorted out long paths
- #38 ability to get simple values from static readonly fields
- version compatible with VS 17.8.1

## Version 2.19.0

- added AssemblyName to symbols to be able to use type containing assembly name in templates

## Version 2.18.0

- version compatible with Visual Studio 17.8.0

## Version 2.17.0

- removing BOM in generated files

## Version 2.16.0

- added IsDictionary and IsDynamic boolean value to Type

## Version 2.15.0

- fix in Guid empty representation in TypeScript

## Version 2.14.0

- added option flag DisableStrictNullGeneration to disable generation of strict null checks in TypeScript

## Version 2.13.0

- [Fixed IsDate property for nullable DateTime and DateTimeOffset](https://github.com/AdaskoTheBeAsT/Typewriter/pull/32) thanks to @ArtemDintecom

## Version 2.12.1

- fixed regression with encodeUriComponent

## Version 2.12.0

- [AdaskoTheBeAsT/Typewriter#22](https://github.com/AdaskoTheBeAsT/Typewriter/issues/22) closed

## Version 2.11.0

- Added single file mode thanks to @nfMalde [PR 20](https://github.com/AdaskoTheBeAsT/Typewriter/pull/20)
- upgraded libs
- upgraded obsoleted code to [IAsyncQuickInfoSourceProvider]

## Version 2.10.1

- version compatible with Visual Studio 17.4.0

## Version 2.10.0

- updated readme

## Version 2.9.2

- Compatible with Visual Studio 17.3.3

## Version 2.9.1

- Compatible with Visual Studio 17.3.2

## Version 2.9.0

- version compatible with Visual Studio 17.3.x
- added special fork of Buildalyzer to be able to run tests - existing
 version of Buildalyzer compatible with net 4.7.2 too old and causing problems with tests

## Version 2.8.1

- fixed tool manifest dependency to require VS 17.2.x

## Version 2.8.0

- version compatible with Visual Studio 17.2.x

## Version 2.7.0

- latest updates for Visual Studio 17.1.x

## Version 2.6.1

- fix relative paths in output directory - now relative to template location

## Version 2.6.0

- ability to setup different output directory in settings.OutputDirectory
- ability to skip adding generated files in project in template by using settings.SkipAddingGeneratedFilesToProject

### Version 2.5.0

- file scoped namespaces C# 10 compatibility

### Version 2.3.1

- exposing solution path in settings

### Version 2.2.6

- compatible with Visual Studio 2022
- [IsNullable support for C# 8 nullable reference types](https://github.com/AdaskoTheBeAsT/Typewriter/pull/1) [RudeySH](https://github.com/RudeySH)

### Version 1.32.0

- added DefaultValue

### Version 1.31.0

- [PR 306 fix typo](https://github.com/frhagn/Typewriter/pull/306) [Shamus03](https://github.com/Shamus03)
- [PR 313 Ignores the Assembler if versions are equals.](https://github.com/frhagn/Typewriter/pull/313) [augustinbcu01](https://github.com/agustinbcu01)
- [PR 328 Url parameters of type DateTime[Offset] should be urlencoded](https://github.com/frhagn/Typewriter/pull/328) [rodro75](https://github.com/rodro75)
- [PR 329 Added IsVirtual to Property metadata](https://github.com/frhagn/Typewriter/pull/329) [Ackhuman](https://github.com/Ackhuman)

### Version 1.30.0

- Added support for C# 9.0 records
- Fixed error for 'string?' type - invalid marked as IsEnumerable